# Parent Data

## My Notes

I love Remix! Just for this one feature that I can use the parent route's loader
to access data in that parent that is not directly available in the child route's loader.

Here is an example of how we get a count of all notes to add to the meta tags
in the `app/routes/users+/$username_+/notes.@noteId.tsx`.

```tsx
// import the paraent route's loader's type
import { type loader as notesLoader } from './notes.tsx'

// strongly type the MetaFunction by using two loaders' types:
// - the "loader" is the route's own loader
// - the "notesLoader" is the parent route's loader
export const meta: MetaFunction<
	typeof loader,
	{ 'routes/users+/$username_+/notes': typeof notesLoader }
> = ({ data, params, matches }) => {
	// try `console.log(matches)` to see what the `matches` object looks like
	// get the parent route's data by its id
	const notesData = matches.find(
		m => m.id === 'routes/users+/$username_+/notes',
	)?.data
	// let us get the owner's name from the notesData (params does not have it)
	const displayName = notesData?.owner.name ?? params.username
	// get the count of notes
	const noteCount = notesData?.notes?.length ?? 0
	...
}
```

If the current route component does not have any loader like `routes/user+/$username_+/notes.index`,
we replace the `typeof loader` with `null` in our MetFunction generic type:

```tsx
export const meta: MetaFunction<
	null,
	{ 'routes/users+/$username_+/notes': typeof notesLoader }
> = ({  params, matches }) => {
	...
}
```

## KcD's Workshop

<EpicVideo url="https://www.epicweb.dev/workshops/full-stack-foundations/search-engine-optimization/optimizing-metadata-for-user-info" />

üë®‚Äçüíº Let's go deeper. When the user shares their notes page (like `/kody/notes`),
it should show something like this:

- **Title**: Kody's Notes | Epic Notes
- **Description**: Checkout Kody's 11 notes on Epic Notes

For this, we'll need to add a meta export to
the <InlineFile file="app/routes/users+/$username_+/notes.index.tsx" /> route.

And then let's say we've got a note like this:

```json
{
	"title": "Not bears",
	"content": "Although you may have heard people call them koala 'bears', these awesome animals aren‚Äôt bears at all ‚Äì they are in fact marsupials. A group of mammals, most marsupials have pouches where their newborns develop."
}
```

When we're on that note's page, it should have:

- **Title**: Not bears | Kody's Notes | Epic Notes
- **Description**: Although you may have heard people call them koala "bears", these awesome animals aren‚Äôt bears at...

For this, we'll need to add a meta export to
the <InlineFile file="app/routes/users+/$username_+/notes.$noteId.tsx" /> route.

The challenge here is those routes don't load enough data for that. The index
route doesn't load any data at all and the note route only loads the note, not
the owner information.

We could definitely add more data in the loader, but even better would be to
access the data that's already there. Here's how you do that:

```tsx filename=app/routes/projects+/$pid.$tid.tsx
// borrowed and modified from the remix docs
import { type loader as projectDetailsLoader } from './$pid'

export async function loader({ params }: LoaderArgs) {
	return json({ task: await getTask(params.tid) })
}

export const meta: MetaFunction<
	typeof loader,
	{ 'routes/project/$pid': typeof projectDetailsLoader }
> = ({ data, matches }) => {
	const project = matches.find(
		match => match.id === 'routes/project/$pid',
	).project
	const task = data.task
	return [{ title: `${project.name}: ${task.name}` }]
}
```

<callout-info>
	It may be helpful to you to add a `console.log(matches)` in the `meta` before
	changing much else so you get an idea of what that object looks like. It's
	especially helpful to find the ID of the route you're looking for.
</callout-info>

Let's add some great meta exports for these routes and access our parent's data
to do it.

- [üìú `meta` export](https://remix.run/docs/en/main/route/meta-v2)
- [üìú `useMatches` hook](https://remix.run/docs/en/main/hooks/use-matches) - How
  you get that `matches` in components. We don't need it in this exercise
  but it may be interesting to you for further exploration.
